!DOCTYPE html>
<html lang="ja">

	<head>

		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="/cgi-bin/stylesheet/modern.css">
		<link rel="icon" href="/cgi-bin/image/favicon.svg">
		<link rel="apple-touch-icon" href="/cgi-bin/image/favicon.svg">
		<title>HOME - sh-MPD -</title>

	</head>

	<body>

		<header>
			<h1>sh-MPD</h1>
			<p>A shell script and CGI-based MPD user interface.</p>
			<p><strong>Host:</strong> localhost | <strong>Port:</strong> 6600</p>
		</header>

		<main>
			<section>
				<h2>Control Panel</h2>
				<form name="control_form" method="GET" action="/cgi-bin/index_process.cgi">
					<div class="control-grid">
						<button name="button" value="status">
							<img src="/cgi-bin/icons/status.svg" class="icon" alt="Status">
							Status
						</button>
						<button name="button" value="volume_-100">
							<img src="/cgi-bin/icons/mute.svg" class="icon" alt="Mute">
							Mute
						</button>
						<button name="button" value="volume_-5">
							<img src="/cgi-bin/icons/vol-down.svg" class="icon" alt="Vol -">
							Vol -
						</button>
						<button name="button" value="volume_+5">
							<img src="/cgi-bin/icons/vol-up.svg" class="icon" alt="Vol +">
							Vol +
						</button>
						<button name="button" value="prev">
							<img src="/cgi-bin/icons/prev.svg" class="icon" alt="Previous">
							Prev
						</button>
						<button name="button" value="toggle">
							<img src="/cgi-bin/icons/toggle.svg" class="icon" alt="Play/Pause">
							Play/Pause
						</button>
						<button name="button" value="stop">
							<img src="/cgi-bin/icons/stop.svg" class="icon" alt="Stop">
							Stop
						</button>
						<button name="button" value="next">
							<img src="/cgi-bin/icons/next.svg" class="icon" alt="Next">
							Next
						</button>
						<button name="button" value="repeat">
							<img src="/cgi-bin/icons/repeat.svg" class="icon" alt="Repeat">
							Repeat
						</button>
						<button name="button" value="random">
							<img src="/cgi-bin/icons/random.svg" class="icon" alt="Random">
							Random
						</button>
						<button name="button" value="single">
							<img src="/cgi-bin/icons/single.svg" class="icon" alt="Single">
							Single
						</button>
						<button name="button" value="shuffle">
							<img src="/cgi-bin/icons/shuffle.svg" class="icon" alt="Shuffle">
							Shuffle
						</button>
						<button name="button" value="clear">
							<img src="/cgi-bin/icons/clear.svg" class="icon" alt="Clear">
							Clear
						</button>
						<button name="button" value="update">
							<img src="/cgi-bin/icons/update.svg" class="icon" alt="Update DB">
							Update DB
						</button>
						<button name="button" value="seek_-5%">
							<img src="/cgi-bin/icons/seek-back.svg" class="icon" alt="Seek -">
							Seek -
						</button>
						<button name="button" value="seek_+5%">
							<img src="/cgi-bin/icons/seek-forward.svg" class="icon" alt="Seek +">
							Seek +
						</button>
					</div>
				</form>
			</section>

			<section>
				<h2>Search</h2>
				<form name="search_form" method="POST" class="search-form" action="/cgi-bin/index_process.cgi">
					<select name="args">
						<option value="searchplay">Fuzzy</option>
						<option value="searchplay artist">Artist</option>
						<option value="searchplay album">Album</option>
						<option value="searchplay title">Title</option>
						<option value="searchplay filename">Filename</option>
					</select>
					<input type="text" placeholder="Enter search term..." name="search">
					<button type="submit">Search</button>
				</form>
			</section>

			<section>
				<h2>Now Playing</h2>
				<form action="/cgi-bin/index_process.cgi" method="GET">
					<button type="submit" name="button" value="status">Refresh Status</button>
				</form>
				<pre>ページをリロードするかStatusボタンでステータスを確認してください。</pre>
				<img class="cover-art" src="/cgi-bin/image/not_playing.svg" alt="Cover Art">
			</section>

			<section>
				<h2>Next in Queue</h2>
				<form name="next_form" method="GET" action="/cgi-bin/index_process.cgi">
					<button name="button" value="next">
						<img src="/cgi-bin/icons/next.svg" class="icon" alt="Next">
						ページをリロードして確認
					</button>
				</form>
			</section>
		</main>

		<aside>
			<nav>
				<h2>Menu</h2>
				<ul>
					<li><a href="/cgi-bin/queued/queued.html">
						<img src="/cgi-bin/icons/queued.svg" class="icon" alt="Queued">
						Queued
					</a></li>
					<li><a href="/cgi-bin/directory/directory.html">
						<img src="/cgi-bin/icons/directory.svg" class="icon" alt="Directory">
						Directory
					</a></li>
					<li><a href="/cgi-bin/playlist/playlist.html">
						<img src="/cgi-bin/icons/playlist.svg" class="icon" alt="Playlist">
						Playlist
					</a></li>
					<li><a href="/cgi-bin/settings/settings.html">
						<img src="/cgi-bin/icons/settings.svg" class="icon" alt="Settings">
						Settings
					</a></li>
				</ul>
			</nav>

			<section>
				<h2>MPD Statistics</h2>
				<form action="/cgi-bin/index_process.cgi" method="GET">
					<button type="submit" name="button" value="status">Refresh Stats</button>
				</form>
				<pre>ページをリロードして統計を確認してください。</pre>
			</section>

			<footer>
				<h3>Links</h3>
				<p><a href="https://github.com/tekkamelon/sh-mpd">GitHub Repository</a></p>
				<p>Reference: <a href="https://github.com/ShellShoccar-jpn/misc-tools">urldecode</a></p>
			</footer>
		</aside>

		<script>
			document.addEventListener('DOMContentLoaded', function() {
				const statusUrl = '/cgi-bin/status.cgi';

				function updateStatusPre(pre) {
					fetch(statusUrl)
						.then(response => response.text())
						.then(text => {
							pre.textContent = text.trim();
						})
						.catch(error => {
							console.error('Status update error:', error);
							pre.textContent = 'Error updating status';
						});
				}

				function autoUpdate() {
					document.querySelectorAll('pre').forEach(pre => {
						if (pre.textContent.includes('ページをリロード') || pre.textContent.includes('確認してください')) {
							updateStatusPre(pre);
						}
					});
				}

				autoUpdate(); // 初回
				setInterval(autoUpdate, 5000); // 5秒ごと

				document.querySelectorAll('button[value="status"]').forEach(button => {
					button.addEventListener('click', function(e) {
						e.preventDefault();
						const form = this.closest('form');
						const section = form.closest('section');
						const pre = section.querySelector('pre');
						if (pre) {
							updateStatusPre(pre);
						}
					});
				});
			});
		</script>
	</body>

</html>